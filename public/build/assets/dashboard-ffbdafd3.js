import{g as d,a as n,b as r,c as o,u as l}from"./api-03a3d816.js";import"./functions-5aea6087.js";async function g(){const t=await d();let e=await n("footprints",t);const s=await r("messages","writer_id",t),a=await r("messages","reader_id",t);if(e||(await o("footprints",{id:t,rights_write:1,rights_read:0}),e=await n("footprints",t)),!a||a.status!=="収得済み")e.rights_read==1?(document.getElementById("rightsBottle").setAttribute("src","img/kara_fullbottle.png"),document.getElementById("readBtn").style.display="block"):e.rights_read==0&&(document.getElementById("rightsBottle").setAttribute("src","img/kara_karabottle.png"),document.getElementById("readBtn").style.display="none");else if(a.status==="収得済み")e.rights_read==1?(document.getElementById("rightsBottle").setAttribute("src","img/kara_fullbottle.png"),document.getElementById("readBtn").style.display="block"):e.rights_read==0&&(document.getElementById("rightsBottle").setAttribute("src","img/kara_karabottle.png"),document.getElementById("readBtn").style.display="block");else{const i={...e,rights_read:0};await l("footprints",t,i),document.getElementById("rightsBottle").setAttribute("src","assets/img/palebottole.png"),document.getElementById("readBtn").style.display="none"}document.getElementById("throwBtn").addEventListener("click",async()=>{!s||s.status!=="下書き"?(await o("messages",{writer_id:t,himitsu:"あなたの秘密をここにお書きください",status:"下書き"}),window.location.href="/message_insert"):s.status==="下書き"&&(window.location.href="/message_insert")}),document.getElementById("readBtn").addEventListener("click",async()=>{!a||a.status!=="収得済み"?window.location.href="/map_read":a.status==="収得済み"&&(window.location.href="/reading_view")})}g();
