import{g as o,a as n,b as r,c as d,u as l}from"./api-03a3d816.js";import"./functions-5aea6087.js";async function m(){const e=await o();let s=await n("footprints",e);const a=await r("messages","writer_id",e),t=await r("messages","reader_id",e);if(s||(await d("footprints",{id:e,rights_write:1,rights_read:0}),s=await n("footprints",e)),!t||t.status!=="収得済み")s.rights_read==1?(document.getElementById("rightsBottle").setAttribute("src","img/kara_fullbottle.png"),document.getElementById("readBtn").classList.remove("hidden"),document.getElementById("throwBtn").classList.remove("hidden")):s.rights_read==0&&(document.getElementById("rightsBottle").setAttribute("src","img/kara_karabottle.png"),document.getElementById("throwBtn").classList.remove("hidden"));else if(t.status==="収得済み")s.rights_read==1?(document.getElementById("rightsBottle").setAttribute("src","img/kara_fullbottle.png"),document.getElementById("readBtn").classList.remove("hidden"),document.getElementById("throwBtn").classList.remove("hidden")):s.rights_read==0&&(document.getElementById("rightsBottle").setAttribute("src","img/kara_karabottle.png"),document.getElementById("readStillBtn").classList.remove("hidden"),document.getElementById("throwBtn").classList.remove("hidden"));else{const i={...s,rights_read:0};await l("footprints",e,i),document.getElementById("rightsBottle").setAttribute("src","assets/img/palebottole.png"),document.getElementById("throwBtn").classList.remove("hidden")}document.getElementById("throwBtn").addEventListener("click",async()=>{!a||a.status!=="下書き"?(await d("messages",{writer_id:e,himitsu:"あなたの秘密をここにお書きください",status:"下書き"}),window.location.href="/message_insert"):a.status==="下書き"&&(window.location.href="/message_insert")}),document.getElementById("readBtn").addEventListener("click",async()=>{!t||t.status!=="収得済み"?window.location.href="/map_read":t.status==="収得済み"&&(window.location.href="/reading_view")}),document.getElementById("readStillBtn").addEventListener("click",async()=>{!t||t.status!=="収得済み"?window.location.href="/map_read":t.status==="収得済み"&&(window.location.href="/reading_view")})}m();
